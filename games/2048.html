<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1">
<title>2048 — Play</title>
<style>
  body{font-family:Arial,Helvetica,sans-serif;background:#f9fafb;color:#111;padding:24px;text-align:center}
  .card{max-width:420px;margin:18px auto;padding:20px;background:#fff;border-radius:12px}
  #board{display:grid;grid-template-columns:repeat(4,80px);gap:10px;justify-content:center}
  .cell{width:80px;height:80px;border-radius:8px;background:#e9ecef;display:flex;align-items:center;justify-content:center;font-weight:700;font-size:18px}
  #controls{margin-top:12px}
  button{padding:8px 12px;border-radius:8px;border:none;background:#2563eb;color:#fff;cursor:pointer}
</style>
</head>
<body>
  <div class="card">
    <h1>2048 — Mini</h1>
    <p>Use arrow keys to move tiles. Merge same numbers to reach 2048.</p>
    <div id="board"></div>
    <div id="controls">
      <button id="new">New Game</button>
      <span id="score" style="margin-left:12px;font-weight:700">Score: 0</span>
    </div>
  </div>

<script>
const boardEl = document.getElementById('board');
let board = [], score = 0;
function init(){
  board = Array.from({length:16},()=>0);
  addTile(); addTile();
  score=0; render();
}
function addTile(){
  const empties = board.map((v,i)=>v===0?i:-1).filter(i=>i!==-1);
  if(!empties.length) return;
  const pos = empties[Math.floor(Math.random()*empties.length)];
  board[pos] = Math.random()<0.9?2:4;
}
function render(){
  boardEl.innerHTML = '';
  board.forEach(v=>{
    const d=document.createElement('div'); d.className='cell'; d.textContent = v===0?'':v;
    boardEl.appendChild(d);
  });
  document.getElementById('score').textContent = 'Score: '+score;
}
function slide(row){
  const arr = row.filter(n=>n);
  for(let i=0;i<arr.length-1;i++){
    if(arr[i]===arr[i+1]){ arr[i]*=2; score+=arr[i]; arr.splice(i+1,1);}
  }
  while(arr.length<4) arr.push(0);
  return arr;
}
function move(dir){
  let moved=false;
  if(dir==='left'){
    for(let r=0;r<4;r++){
      const row = board.slice(r*4,r*4+4);
      const newRow = slide(row);
      for(let i=0;i<4;i++){ if(board[r*4+i]!==newRow[i]) moved=true; board[r*4+i]=newRow[i]; }
    }
  } else if(dir==='right'){
    for(let r=0;r<4;r++){
      const row = board.slice(r*4,r*4+4).reverse();
      const newRow = slide(row).reverse();
      for(let i=0;i<4;i++){ if(board[r*4+i]!==newRow[i]) moved=true; board[r*4+i]=newRow[i]; }
    }
  } else if(dir==='up'){
    for(let c=0;c<4;c++){
      const col=[board[c],board[c+4],board[c+8],board[c+12]];
      const newCol = slide(col);
      for(let i=0;i<4;i++){ if(board[c+4*i]!==newCol[i]) moved=true; board[c+4*i]=newCol[i]; }
    }
  } else if(dir==='down'){
    for(let c=0;c<4;c++){
      const col=[board[c],board[c+4],board[c+8],board[c+12]].reverse();
      const newCol = slide(col).reverse();
      for(let i=0;i<4;i++){ if(board[c+4*i]!==newCol[i]) moved=true; board[c+4*i]=newCol[i]; }
    }
  }
  if(moved){ addTile(); render(); if(checkLost()) alert('No moves left — Game Over'); }
}
function checkLost(){
  if(board.some(v=>v===0)) return false;
  for(let i=0;i<16;i++){
    const r=Math.floor(i/4), c=i%4;
    if(c<3 && board[i]===board[i+1]) return false;
    if(r<3 && board[i]===board[i+4]) return false;
  }
  return true;
}
document.addEventListener('keydown',e=>{
  if(e.key.includes('Arrow')){ e.preventDefault();
    if(e.key==='ArrowLeft') move('left');
    if(e.key==='ArrowRight') move('right');
    if(e.key==='ArrowUp') move('up');
    if(e.key==='ArrowDown') move('down');
  }
});
document.getElementById('new').onclick = init;
init();
</script>
</body>
</html>
